\subsection{The semantics of extension}
\begin{defn}
A \emph{pre-extension algebra $\stesys$ in $\cat{C}$} consists of a fundamental structure
$\stesys$
in $\cat{C}$ together with the \emph{context extension} and \emph{family extension} operations
\begin{align*}
\ectxext &:\stesysf\to \stesysc\\
\efamext & :\stesysff\to \stesysf,
\end{align*}
respectively, such that the diagram
\begin{equation*}
\begin{tikzcd}
\stesysf_2 
  \ar{r}{\efamext} 
  \ar{d}[swap]{\eft[2]} 
  & 
\stesysf 
  \ar{d}{\eft}
  \\
\stesysf
  \ar{r}[swap]{\eft} 
  & 
\stesysc
\end{tikzcd}
\end{equation*}
commutes.
\end{defn}

In the following we give an inductive definition of $\stesysf_n$ $\eft[n]$, $\eext{n}$,
$\stesyst_n$ and $\ebd[n]$. This is more than we need in this article, because
we will only make use of the first few instances.
\begin{defn}
Set $\stesysf_0:=\stesysc$, $\stesysf_1:=\stesys$ and $\eft[1]:=\eft$. We define
\begin{equation*}
\stesysf_{2} 
  := \pullback{\stesysf}{\stesysf}{\ectxext}{\eft}
\end{equation*}
By induction on the natural numbers $n\geq 1$, we define $\stesysf_{n+2}$, $\eft[n+1]$ and
$\eext{n+1}$ simultaneously, by
\begin{align*}
\stesysf_{n+2} 
  & := \pullback{\stesysf_{n+1}}{\stesysf_{n+1}}{\eext{n}}{\eft[n+1]}
  \\
\eft[n+1] 
  & := \pullbackpr{1}{\eext{n}}{\eft[n+1]} : \stesysf_{n+2}\to\stesysf_{n+1}
\end{align*}
As inductive hypothesis we require that the outer square in the diagram
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\stesysf_{n+2}
  \ar[dotted]{dr}{\eext{n+1}}
  \ar{rr}{\pullback{\pullbackpr{2}{\eext{n-1}}{\eft[n]}}{\pullbackpr{2}{\eext{n-1}}{\eft[n]}}{\eext{n-1}}{\eft[n]}}
  \ar{dd}[swap]{\eft[n+2]}
  & 
  &
\stesysf_{n+1}
  \ar{d}{\eext{n}}
  \\
  &
\stesysf_{n+1}
  \ar{d}[swap]{\eft[n+1]}
  \ar{r}{\pullbackpr{2}{\eext{n-1}}{\eft[n]}}
  &
\stesysf_{n}
  \ar{d}{\eft[n]}
  \\
\stesysf_{n+1}
  \ar{r}[swap]{\eft[n+1]}
  &
\stesysf_{n}
  \ar{r}[swap]{\eext{n-1}}
  &
\stesysf_{n-1}
\end{tikzcd}
\end{equation*}
commutes, which is clear in the base case $n=1$. Now we define $\eext{n+1}$ to be the
unique morphism rendering the above diagram commutative.

Similarly, we define
\begin{align*}
\stesyst_{n+1} 
  & := \pullback{\stesysf_n}{\stesyst_n}{\eext{n-1}}{\eft[n]\circ\ebd[n]}
  \\
\ebd[n+1]
  & := \eext{n-1}^\ast(\ebd[n])
\end{align*}
for $n\geq 1$, where we take $\stesyst_1:=\stesyst$ and $\ebd[1]:=\ebd$.
\end{defn}

\begin{defn} 
An extension algebra is a pre-extension algebra $\stesys$ for which 
the diagrams
\begin{equation*}
\begin{tikzcd}
\stesysf_2 
  \ar{d}[swap]{\pullbackpr{2}{\ectxext}{\eft}} 
  \ar{r}{\efamext} 
  & 
\stesysf 
  \ar{d}{\ectxext}
  \\
\stesysf 
  \ar{r}[swap]{\ectxext} 
  & 
\stesysc
\end{tikzcd}
\qquad
\begin{tikzcd}
\stesysf_3
  \ar{d}[swap]{\pullbackpr{2}{\efamext}{\eft[2]}}
  \ar{r}{\eext{2}}
  & 
\stesysf_2 
  \ar{d}{\efamext} 
  \\
\stesysf_2 
  \ar{r}[swap]{\efamext} 
  &
\stesysf
\end{tikzcd}
\end{equation*}
commute.
\end{defn}

\begin{comment}
\begin{lem}
There exists an isomorphism $\alpha$ such that the triangle
\begin{equation*}
\begin{tikzcd}[column sep=tiny]
\pullback{\stesysf}{\stesysf_2}{\ectxext}{\eft\circ\eft[2]}
  \ar[dotted]{rr}{\alpha}
  \ar{dr}[swap]{\pullback{\catid{\stesysf}}{\efamext}{\ectxext}{\eft}}
  &
  &
\stesysf_3
  \ar{dl}{\eext{2}}
  \\
& \stesysf_2
\end{tikzcd}
\end{equation*}
commutes
\end{lem}

\begin{proof}
There is a unique morphism $\alpha:
\pullback{\stesysf}{\stesysf_2}{\ectxext}{\eft\circ\eft[2]}\to\stesysf_3$
rendering the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\pullback{\stesysf}{\stesysf_2}{\ectxext}{\eft\circ\eft[2]}
  \ar[bend left=10,yshift=.5ex]{drrr}{\pullbackpr{2}{\ectxext}{\eft}\circ\pullbackpr{2}{\ectxext}{\eft\circ\eft[2]}}
  \ar[bend right=10]{ddr}[swap]{\pullback{\catid{\stesysf}}{\eft[2]}{\ectxext}{\eft}}
  \ar[dotted]{dr}{\alpha}
  \\
& \stesysf_3
  \ar{r}{\pullbackpr{2}{\efamext}{\eft[2]}}
  \ar{d}{\eft[3]}
  &
\stesysf_2
  \ar{d}[swap]{\eft[2]}
  \ar{r}[swap]{\pullbackpr{2}{\ectxext}{\eft}}
  &
\stesysf
  \ar{d}{\eft}
  \\
{} & \stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
  \ar{r}[swap]{\ectxext}
  &
\stesysc
\end{tikzcd}
\end{equation*}
\end{proof}
\end{comment}

\begin{defn}
Suppose $\stesys$ is a pre-extension algebra of $\cat{C}$. Then we define the pre-extension algebra
$\famesys{\stesys}$ to consist of the fundamental structure
\begin{equation*}
\begin{tikzcd}
\stesyst_2
  \ar{d}{\ebd[2]}
  \\
\stesysf_2
  \ar{d}{\eft[2]}
  \\
\stesysf
\end{tikzcd}
\end{equation*}
with the extension operations
\begin{align*}
\efamext 
  & 
  : \stesysf_2\to\stesysf\\
\eext{2} & : \stesysf_3\to\stesysf_2.
\end{align*}
\end{defn}

In \autoref{famextobj} below we shall show that $\famesys{\stesys}$ is an
extension algebra whenever $\stesys$ is an extension algebra. We shall need
a handful of lemmas to give the proof.

\begin{defn}
We define $\beta_n:\stesysf_{n+1}\to\stesysf_n$ for $n\geq 1$ by
\begin{align*}
\beta_1 
  & := 
\pullbackpr{2}{\ectxext}{\eft}
  & &
  : \stesysf_2\to\stesysf
  \\
\beta_{n+1}
  & :=
\pullback{\beta_n}{\beta_n}{\eext{n-1}}{\eft[n]}
  & &
  : \stesysf_{n+2}\to\stesysf_{n+1}
\end{align*}
\end{defn}

\begin{lem}
Let $\stesys$ be a pre-extension algebra. Then the square
\begin{equation*}
\begin{tikzcd}[column sep=10em]
\stesysf_4
  \ar{r}{\pullback{\pullbackpr{2}{\efamext}{\eft[2]}}{\pullbackpr{2}{\efamext}{\eft[2]}}{\efamext}{\eft[2]}}
  \ar{d}[swap]{\beta_3}
  &
\stesysf_3
  \ar{d}{\beta_2}
  \\
\stesysf_3
  \ar{r}[swap]{\beta_2}
  &
\stesysf_2
\end{tikzcd}
\end{equation*}
commutes.
\end{lem}

\begin{proof}
Left to the reader.
\end{proof}

\begin{comment}
\begin{proof}
It is straightforward to verify the equalities
\begin{align*}
\pullbackpr{1}{\ectxext}{\eft}\circ\beta_2\circ
  (\pullback{\pullbackpr{2}{\efamext}{\eft[2]}}{\pullbackpr{2}{\efamext}{\eft[2]}}{\efamext}{\eft[2]})
  & =
\pullbackpr{1}{\ectxext}{\eft}\circ\beta_2\circ\beta_3
  \\
\pullbackpr{2}{\ectxext}{\eft}\circ\beta_2\circ
  (\pullback{\pullbackpr{2}{\efamext}{\eft[2]}}{\pullbackpr{2}{\efamext}{\eft[2]}}{\efamext}{\eft[2]})
  & =
\pullbackpr{2}{\ectxext}{\eft}\circ\beta_2\circ\beta_3.\qedhere
\end{align*}
\end{proof}
\end{comment}

Note that the square
\begin{equation*}
\begin{tikzcd}
\stesysf_3
  \ar{r}{\beta_2}
  \ar{d}[swap]{\eext{2}}
  &
\stesysf_2
  \ar{d}{\efamext}
  \\
\stesysf_2
  \ar{r}[swap]{\beta_1}
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutes by definition. We have a similar result relating $\eext{3}$ and
$\eext{2}$.

\begin{lem}
Let $\stesys$ be a pre-extension algebra. Then the square
\begin{equation*}
\begin{tikzcd}
\stesysf_4
  \ar{r}{\beta_3}
  \ar{d}[swap]{\eext{3}}
  &
\stesysf_3
  \ar{d}{\eext{2}}
  \\
\stesysf_3
  \ar{r}[swap]{\beta_2}
  &
\stesysf_2
\end{tikzcd}
\end{equation*}
commutes.
\end{lem}

\begin{proof}
Left to the reader.
\end{proof}
\begin{comment}
\begin{proof}
It is straightforward to verify the equalities
\begin{align*}
\pullbackpr{1}{\ectxext}{\eft}\circ\beta_2\circ\eext{3}
  & = \beta_1\circ\eft[3]\circ\eft[4]
  \\
\pullbackpr{1}{\ectxext}{\eft}\circ\eext{2}\circ\beta_3
  & = \beta_1\circ\eft[3]\circ\eft[4].
\end{align*}
Thus, it remains to verify that
\begin{equation*}
\pullbackpr{2}{\ectxext}{\eft}\circ\beta_2\circ\eext{3}
  = \pullbackpr{2}{\ectxext}{\eft}\circ\eext{2}\circ\beta_3.
\end{equation*}
It is straightforward to see that the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\stesysf_4
  \ar{dd}[swap]{\pullback{\pullbackpr{2}{\efamext}{\eft[2]}}{\pullbackpr{2}{\efamext}{\eft[2]}}{\efamext}{\eft[2]}}
  \ar{r}{\eext{3}}
  &
\stesysf_3
  \ar{r}{\beta_2}
  \ar{d}[swap]{\pullbackpr{2}{\efamext}{\eft[2]}}
  &
\stesysf_2
  \ar{dd}{\pullbackpr{2}{\ectxext}{\eft}}
  \\
  {} &
\stesysf_2
  \ar{dr}{\beta_1}
  \\
\stesysf_3
  \ar{ur}{\eext{2}}
  \ar{r}[swap]{\beta_2}
  &
\stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutes. It is likewise straightforward to see that the diagram
\begin{equation*}
\begin{tikzcd}
\stesysf_4
  \ar{r}{\beta_3}
  \ar{d}[swap]{\pullback{\pullbackpr{2}{\efamext}{\eft[2]}}{\pullbackpr{2}{\efamext}{\eft[2]}}{\efamext}{\eft[2]}}
  &
\stesysf_3
  \ar{r}{\eext{2}}
  \ar{d}[swap]{\beta_2}
  &
\stesysf_2
  \ar{d}{\pullbackpr{2}{\ectxext}{\eft}}
  \\
\stesysf_3
  \ar{r}[swap]{\beta_2}
  &
\stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutes, completing our goal.
\end{proof}
\end{comment}

\begin{thm}[Local extension structure]\label{famextobj}
If $\stesys$ is an extension algebra, then so is $\famesys{\stesys}$.
\end{thm}

\begin{proof}
Note that the diagram
\begin{equation*}
\begin{tikzcd}
\stesysf_3
  \ar{d}[swap]{\pullbackpr{2}{\efamext}{\eft[2]}}
  \ar{r}{\eext{2}}
  & 
\stesysf_2 
  \ar{d}{\efamext} 
  \\
\stesysf_2 
  \ar{r}[swap]{\efamext} 
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutes by assumption. For the second condition, we have to show that the
diagram
\begin{equation*}
\begin{tikzcd}
\stesysf_4
  \ar{d}[swap]{\pullbackpr{2}{\eext{2}}{\eft[3]}}
  \ar{r}{\eext{3}}
  & 
\stesysf_3
  \ar{d}{\eext{2}} 
  \\
\stesysf_3
  \ar{r}[swap]{\eext{2}} 
  &
\stesysf_2
\end{tikzcd}
\end{equation*}
Since this is a question about two maps into a pullback, it suffices to verify
that
\begin{align*}
\pullbackpr{1}{\ectxext}{\eft}\circ\eext{2}\circ\eext{3}
  & =
\pullbackpr{1}{\ectxext}{\eft}\circ\eext{2}\circ\pullbackpr{2}{\eext{2}}{\eft[3]}
  \\
\pullbackpr{2}{\ectxext}{\eft}\circ\eext{2}\circ\eext{3}
  & =
\pullbackpr{2}{\ectxext}{\eft}\circ\eext{2}\circ\pullbackpr{2}{\eext{2}}{\eft[3]}.
\end{align*}
For the first equality, it is fairly straightforward to show that both the
equalities
\begin{equation*}
\pullbackpr{1}{\ectxext}{\eft}\circ\eext{2}\circ\eext{3}
  =
\eft[2]\circ\eft[3]\circ\eft[4]
\end{equation*}
and
\begin{equation*}
\pullbackpr{1}{\ectxext}{\eft}\circ\eext{2}\circ\pullbackpr{2}{\eext{2}}{\eft[3]}
  =
\eft[2]\circ\eft[3]\circ\eft[4].
\end{equation*}
hold. For the second subgoal (which is more tricky). Notice first that the
diagram
\begin{equation*}
\begin{tikzcd}
\stesysf_4
  \ar{r}{\eext{3}}
  \ar{d}[swap]{\beta_3}
  &
\stesysf_3
  \ar{r}{\eext{2}}
  \ar{d}[swap]{\beta_2}
  &
\stesysf_2
  \ar{d}{\pullbackpr{2}{\ectxext}{\eft}}
  \\
\stesysf_3
  \ar{r}[swap]{\eext{2}}
  &
\stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutes. We also have the commutative diagram
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\stesysf_4
  \ar{r}{\pullbackpr{2}{\eext{2}}{\eft[3]}}
  \ar{d}[swap]{\beta_3}
  &
\stesysf_3
  \ar{dr}{\eext{2}}
  \ar{d}[swap]{\beta_2}
  \\
\stesysf_3
  \ar{r}{\pullbackpr{2}{\efamext}{\eft[2]}}
  \ar{dr}[swap]{\eext{2}}
  &
\stesysf_2
  \ar{dr}{\efamext}
  &
\stesysf_2
  \ar{d}{\pullbackpr{2}{\ectxext}{\eft}}
  \\
  {} &
\stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
\end{tikzcd}
\end{equation*}
completing the proof.
\end{proof}

\subsection{(Pre-)extension homomorphisms}\label{subsection:e_extension_homomorphisms}
In this subsection we start with the study of pre-extension homomorphisms, which
will include the extension homomorphisms since they will be the pre-extension
homomorphisms of which both the domain and codomain are extension algebras.
Our main examples of extension homomorphisms will be the operations of weakening
and substitution. There are some basic examples of pre-extension homomorphisms
that will be useful too, which get introduced in the this section and in
\autoref{subsection:change_of_base}. In this section, we will mainly be
interested in pre-extension homomorphisms between local pre-extension algebras.
We will end this section by proving that a retract of an extension algebra is
always an extension algebra.

\begin{defn}
Let $\stesys$ and $\stesys'$ be pre-extension algebras. A \emph{pre-extension 
homomorphism $f$ from $\stesys'$ to $\stesys$} is a triple $(f_0,f_1,f^t)$ 
consisting of morphisms
\begin{equation*}
\begin{tikzcd}
\stesyst' 
  \ar{r}{f^t}
  \ar{d}[swap]{\ebd'}
  &
\stesyst
  \ar{d}{\ebd}
  \\
\stesysf'
  \ar{r}{f_1}
  \ar{d}[swap]{\eft'}
  &
\stesysf
  \ar{d}{\eft}
  \\
\stesysc' 
  \ar{r}[swap]{f_0}
  &
\stesysc
\end{tikzcd}
\end{equation*}
such that the indicated squares commute, for which furthermore the squares
\begin{equation*}
\begin{tikzcd}
\stesysf' 
  \ar{r}{f_1}
  \ar{d}[swap]{\ectxext'}
  &
\stesysf
  \ar{d}{\ectxext}
  \\
\stesysc'
  \ar{r}[swap]{f_0}
  &
\stesysc
\end{tikzcd}
\end{equation*}
and
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\stesysf'\times_{\ectxext',\eft'} \stesysf'
  \ar{r}{f_1\times_{\ectxext,\eft} f_1}
  \ar{d}[swap]{\efamext'}
  &
\stesysf\times_{\ectxext,\eft} \stesysf
  \ar{d}{\efamext}
  \\
\stesysf'
  \ar{r}[swap]{f_1}
  &
\stesysf
\end{tikzcd}
\end{equation*}
Composition and the identity homomorphism are defined in the expected way. We
define furthermore
\begin{align*}
f_2 & := \pullback{f_1}{f_1}{\ectxext}{\eft}
  \\
f_3 & := \pullback{f_2}{f_2}{\efamext}{\eft[2]}.
\end{align*}
\end{defn}

\begin{defn}
A pre-extension homomorphism between extension algebras is called an extension
homomorphism.
\end{defn}

\begin{lem}
Let $\stesys$ be an extension algebra. Then
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\stesyst_2
  \ar{r}{\pullbackpr{2}{\ectxext}{\eft\circ\ebd}}
  \ar{d}[swap]{\ebd[2]}
  &
\stesyst
  \ar{d}{\ebd}
  \\
\stesysf_2
  \ar{r}{\pullbackpr{2}{\ectxext}{\eft}}
  \ar{d}[swap]{\eft[2]}
  &
\stesysf
  \ar{d}{\eft}
  \\
\stesysf
  \ar{r}[swap]{\ectxext}
  &
\stesysc
\end{tikzcd}
\end{equation*}
assembles an extension homomorphism $\mathbf{e}_0:\famesys{\stesys}\to\stesys$.
Likewise, we have an extension homomorphism
$\mathbf{e}_1:\famesys{\famesys{\stesys}}\to\famesys{\stesys}$. Thus, a
pre-extension algebra is an extension algebra if and only if $\mathbf{e}_0$
and $\mathbf{e}_1$ are pre-extension homomorphisms.
\end{lem}

\begin{proof}
Immediate from the conditions of being an extension algebra.
\end{proof}

\begin{defn}
Let $\stesys$ be a pre-extension algebra. Then
\begin{equation*}
\begin{tikzcd}
\stesyst_3
  \ar{r}{\beta^t}
  \ar{d}[swap]{\ebd[3]}
  &
\stesyst_2
  \ar{d}{\ebd[2]}
  \\
\stesysf_3
  \ar{r}{\beta_2}
  \ar{d}[swap]{\eft[3]}
  &
\stesysf_2
  \ar{d}{\eft[2]}
  \\
\stesysf_2
  \ar{r}[swap]{\beta_1}
  &
\stesysf
\end{tikzcd}
\qquad
\text{and}
\qquad
\begin{tikzcd}
\stesyst_4
  \ar{r}{\beta^t_2}
  \ar{d}[swap]{\ebd[4]}
  &
\stesyst_3
  \ar{d}{\ebd[3]}
  \\
\stesysf_4
  \ar{r}{\beta_3}
  \ar{d}[swap]{\eft[4]}
  &
\stesysf_3
  \ar{d}{\eft[3]}
  \\
\stesysf_3
  \ar{r}[swap]{\beta_2}
  &
\stesysf_2
\end{tikzcd}
\end{equation*}
assemble pre-extension homomorphisms 
\(
\boldsymbol{\beta}
  :
\famesys{\famesys{\stesys}}
  \to
\famesys{\stesys}
\) 
and
\(
\boldsymbol{\beta}_\mathbf{2}
  :
\famesys{\famesys{\famesys{\stesys}}}
  \to
\famesys{\famesys{\stesys}}
\).
\end{defn}

\begin{defn}\label{famehom}
Suppose that $f:\stesys'\to\stesys$ is a pre-extension homomorphism. Then we
define $\famehom{f}:\famesys{\stesys'}\to\famesys{\stesys}$ to consist of
\begin{equation*}
\begin{tikzcd}
\stesyst_2'
  \ar{r}{f^t_2}
  \ar{d}[swap]{\ebd[2]'}
  &
\stesyst_2
  \ar{d}{\ebd[2]}
  \\
\stesysf_2'
  \ar{r}{f_2}
  \ar{d}[swap]{\eft[2]'}
  &
\stesysf_2
  \ar{d}{\eft[2]}
  \\
\stesysf'
  \ar{r}[swap]{f_1}
  &
\stesysf
\end{tikzcd}
\end{equation*}
where we define
\begin{equation*}
f^t_2 := \pullback{f_1}{f^t}{\ectxext}{\eft\circ\ebd}.
\end{equation*}
\end{defn}

\begin{lem}
The triple $\famehom{f}$ defined in \autoref{famehom} is a pre-extension homomorphism.
\end{lem}

\begin{proof}
Note that the square
\begin{equation*}
\begin{tikzcd}
\stesysf_2'
  \ar{r}{f_2}
  \ar{d}[swap]{\efamext'}
  &
\stesysf_2
  \ar{d}{\efamext}
  \\
\stesysf'
  \ar{r}[swap]{f_1}
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutes by assumption. Thus, it remains to show that the square
\begin{equation*}
\begin{tikzcd}
\stesysf_3'
  \ar{r}{f_3}
  \ar{d}[swap]{\eext{2}'}
  &
\stesysf_3
  \ar{d}{\eext{2}}
  \\
\stesysf_2'
  \ar{r}[swap]{f_2}
  &
\stesysf_2
\end{tikzcd}
\end{equation*}
commutes. It is equivalent to show that the equalities
\begin{align*}
\pullbackpr{1}{\ectxext}{\eft}\circ f_2\circ\eext{2}'
  & =
\pullbackpr{1}{\ectxext}{\eft}\circ \eext{2}\circ f_3
  \\
\pullbackpr{2}{\ectxext}{\eft}\circ f_2\circ\eext{2}'
  & =
\pullbackpr{2}{\ectxext}{\eft}\circ \eext{2}\circ f_3
\end{align*}
both hold. For the first, it is straightforward to verify that the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
{} &
\stesysf_2'
  \ar{r}{f_2}
  \ar{dr}[near end]{\pullbackpr{1}{\ectxext'}{\eft'}}
  &
\stesysf_2
  \ar{dr}{\pullbackpr{1}{\ectxext}{\eft}}
  \\
\stesysf_3'
  \ar{ur}{\eext{2}'}
  \ar{r}[swap]{\beta_2'}
  \ar{ddr}[swap]{f_3}
  &
\stesysf_2'
  \ar{r}{\efamext'}
  \ar{dr}[swap]{f_2}
  &
\stesysf'
  \ar{r}{f_1}
  &
\stesysf
  \\
{} & {} &
\stesysf_2
  \ar{ur}[near start]{\efamext}
  \\
{} &
\stesysf_3
  \ar{r}[swap]{\eext{2}}
  \ar{ur}{\beta_2}
  &
\stesysf_2
  \ar{uur}[swap]{\pullbackpr{1}{\ectxext}{\eft}}
\end{tikzcd}
\end{equation*}
commutes. For the second, note that the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
{} &
\stesysf_2'
  \ar{r}{f_2}
  \ar{dr}{\beta_1'}
  &
\stesysf_2
  \ar{ddr}{\pullbackpr{2}{\ectxext}{\eft}}
  \\
{} & {} &
\stesysf'
  \ar{dr}[swap,near start]{f_1}
  \\
\stesysf_3'
  \ar{uur}{\eext{2}'}
  \ar{r}{\beta_2'}
  \ar{dr}[swap]{f_3}
  &
\stesysf_2'
  \ar{r}{f_2}
  \ar{ur}{\efamext'}
  &
\stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
  \\
{} &
\stesysf_3
  \ar{r}[swap]{\eext{2}}
  \ar{ur}[near start]{\beta_2}
  &
\stesysf_2
  \ar{ur}[swap]{\pullbackpr{2}{\ectxext}{\eft}}
\end{tikzcd}
\end{equation*}
commutes.
\end{proof}

\begin{lem}[Stability under retracts]\label{esys-retract}
Suppose $f:\stesys\to\stesys'$ is a pre-extension homomorphism between
pre-extension algebras. If there is a pre-extension homomorphism $g:\stesys'\to
\stesys$ such that $g\circ f=\catid{\stesys}$ and $\stesys'$ is an extension
algebra, then $\stesys$ is an extension algebra.
\end{lem}

Before we start with the proof, note that we have the equalities
$g_2\circ f_2=\catid{\stesysf_2}$ and $g_3\circ f_3=\catid{\stesysf_3}$
under the hypotheses of the lemma.

\begin{proof}
Our first subgoal is to show that the square
\begin{equation*}
\begin{tikzcd}
\stesysf_2 
  \ar{r}{\efamext} 
  \ar{d}[swap]{\pullbackpr{2}{\ectxext}{\eft}} 
  & 
\stesysf 
  \ar{d}{\ectxext}
  \\
\stesysf
  \ar{r}[swap]{\ectxext} 
  & 
\stesysc
\end{tikzcd}
\end{equation*}
commutes. Note that in the diagram
\begin{equation*}
\begin{tikzcd}
  {}
  & 
\stesysf
  \ar{dd}[near start]{\ectxext}
  \ar{rr}{f_1}
  &
  &
\stesysf'
  \ar{dd}[near start]{\ectxext'}
  \ar{rr}{g_1}
  &
  &
\stesysf
  \ar{dd}{\ectxext}
  \\
\stesysf_2
  \ar{dd}[swap]{\pullbackpr{2}{\ectxext}{\eft}}
  \ar[crossing over]{rr}[swap,near start]{f_2}
  \ar{ur}{\efamext}
  &
  &
\stesysf_2'
  \ar{ur}[near start]{\efamext'}
  \ar[crossing over]{rr}[swap,near start]{g_2}
  &
  &
\stesysf_2
  \ar{ur}[swap,near start]{\efamext}
  \\
  {}
  &
\stesysc
  \ar{rr}[near start]{f_0}
  &
  &
\stesysc'
  \ar{rr}[near start]{g_0}
  &
  &
\stesysc
  \\
\stesysf 
  \ar{rr}[swap]{f_1}
  \ar{ur}{\ectxext}
  &
  &
\stesysf' 
  \ar[crossing over,leftarrow]{uu}[near end,swap]{\pullbackpr{2}{\ectxext'}{\eft'}}
  \ar{ur}[swap,near end]{\ectxext'}
  \ar{rr}[swap]{g_1}
  &
  &
\stesysf
  \ar[crossing over,leftarrow]{uu}[near end,swap]{\pullbackpr{2}{\ectxext}{\eft}}
  \ar{ur}[swap]{\ectxext}
\end{tikzcd}
\end{equation*}
all the faces minus the far left and far right face commute. Using that $g$
is a section of $f$, we can read off that also the far left face commutes,
completing our first subgoal.
 
For the second subgoal, note that also $\famehom{g}\circ\famehom{f}=
\catid{\famesys{\stesys}}$ and that $\famesys{\stesys'}$ is an extension algebra.
Thus we can apply what we have proven so far to conclude that the square
\begin{equation*}
\begin{tikzcd}
\stesysf_3 
  \ar{r}{\eext{2}} 
  \ar{d}[swap]{\pullbackpr{2}{\efamext}{\eft[2]}} 
  & 
\stesysf_2 
  \ar{d}{\efamext}
  \\
\stesysf_2
  \ar{r}[swap]{\efamext} 
  & 
\stesysf
\end{tikzcd}
\end{equation*}
commutes.
\end{proof}

\subsection{The change of base of (pre-)extension algebras}
\label{subsection:change_of_base}
An important construction of (pre-)extension algebras is the change of base. It
allows us to consider `parametrized homomorphisms', such as weakening and
substitution.

\begin{defn}
Suppose $f:\stesys\to\stesys'$ is a pre-extension homomorphism. We say that
a diagram
\begin{equation*}
\begin{tikzcd}
\stesys
  \ar{r}{f}
  \ar{d}[swap]{p}
  &
\stesys'
  \ar{d}{p'}
  \\
X \ar{r}[swap]{g}
  &
Y
\end{tikzcd}
\end{equation*}
commutes if the diagram
\begin{equation*}
\begin{tikzcd}
\stesysc
  \ar{r}{f_0}
  \ar{d}[swap]{p}
  &
\stesysc'
  \ar{d}{p'}
  \\
X \ar{r}[swap]{g}
  &
Y
\end{tikzcd}
\end{equation*}
commutes.
\end{defn}

The first goal in this subsection is to define for every (pre-)extension algebra 
$\stesys$ and every $p:\stesysc\rightarrow X\leftarrow Y:g$, a (pre-)extension
algebra $\cobesys{Y}{\stesys}{g}{p}$ with a homomorphism $\pullbackpr{2}{g}{p}:
\cobesys{Y}{\stesys}{g}{p}\to\stesys$ and a morphism $\pullbackpr{1}{g}{p}:
\pullback{Y}{\stesysc}{g}{p}\to Y$ such that for every diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\stesys'
  \ar[bend right=10]{ddr}[swap]{p'}
  \ar[bend left=10]{rrd}{f}
  \ar[dotted]{dr}[near end]{[p',f]}
  \\
  {}&
\cobesys{Y}{\stesys}{g}{p}
  \ar{d}{\pullbackpr{1}{g}{p}}
  \ar{r}[swap]{\pullbackpr{2}{g}{p}}
  &
\stesys
  \ar{d}{p}
  \\
  {}&
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*}
of which the outer square commutes, the (pre-)extension homomorphism $[p',f]$ exists
and is unique with the property that it renders the diagram commutative. We will
give the definition of $\cobesys{Y}{\stesys}{g}{p}$ in \autoref{cobesys}. After
proving that the change of base of a pre-extension algebra is indeed a
pre-extension algebra (\autoref{cobesys-preext}) and that the change of base
of an extension algebra is an extension algebra (\autoref{cobesys-ext}), we
will demonstrate the above unique existence in \autoref{cobesys-existence,%
cobesys-pullback}.

The second goal in this subsection is to follow the same procedure for
$\famesys{\famesys{\stesys}}$ to show that it is equivalent to
$\cobesys{\stesysf}{\famesys{\stesys}}{\ectxext}{\eft}$. We will do this by
verifying directly that it has the universal property of the change of base
described above, because we will use the ingredients in our definition of
weakening and substitution algebras.

\begin{defn}[Change of base]\label{cobesys}
Suppose $\stesys$ is a pre-extension algebra in $\cat{C}$ and that 
$p:\stesysc\rightarrow X\leftarrow Y:g$.
Then we define the pre-extension algebra $\cobesys{Y}{\stesys}{g}{p}$ to consist of
\begin{equation*}
\begin{tikzcd}
\cobesys{Y}{\stesyst}{g}{p\circ\eft\circ\ebd}
  \ar{r}
  \ar{d}[swap]{g^\ast(\ebd)}
  &
\stesyst
  \ar{d}{\ebd}
  \\
\cobesys{Y}{\stesysf}{g}{p\circ\eft}
  \ar{r}
  \ar{d}[swap]{g^\ast(\eft)}
  &
\stesysf
  \ar{d}{\eft}
  \\
\cobesys{Y}{\stesysc}{g}{p}
  \ar{r}
  \ar{d}[swap]{\pullbackpr{1}{g}{p}}
  &
\stesysc
  \ar{d}{p}
  \\
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*} 
and the operations
\begin{align*}
\cobesys{Y}{\ectxext}{g}{p} 
  & : \pullback{Y}{\stesysf}{g}{p\circ\eft}\to \pullback{Y}{\stesysc}{g}{p}\\
\cobesys{Y}{\efamext}{g}{p} 
  & : \pullback
    {\pullback{Y}{\stesysf}{g}{p\circ\eft}}
    {\pullback{Y}{\stesysf}{g}{p\circ\eft}}
    {\cobesys{Y}{\ectxext}{g}{p}}
    {g^\ast(\eft)}
  \to 
  \pullback{Y}{\stesysf}{g}{p\circ\eft}.
\end{align*}
defined by
\begin{equation*}
\cobesys{Y}{\ectxext}{g}{p} := \pullback{\catid{Y}}{\ectxext}{g}{p}
\end{equation*}
and where $\cobesys{Y}{\efamext}{g}{p}$ is defined by rendering the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
(\cobesys{Y}{\stesysf}{g}{p\circ\eft})_2
  \ar{rr}{\pullback{\pullbackpr{2}{g}{p\circ\eft}}{\pullbackpr{2}{g}{p\circ\eft}}{\ectxext}{\eft}}
  \ar{dd}[swap]{\pullbackpr{1}{\cobesys{Y}{\ectxext}{g}{p}}{g^\ast(\eft)}}
  \ar[dotted]{dr}[swap]{\cobesys{Y}{\efamext}{g}{p}}
  &
  &
\stesysf_2
  \ar{d}{\efamext}
  \\
  {}&
\cobesys{Y}{\stesysf}{g}{p\circ\eft}
  \ar{r}{\pullbackpr{2}{g}{p\circ\eft}}
  \ar{d}[swap]{\pullbackpr{1}{g}{p\circ\eft}}
  &
\stesysf
  \ar{d}{p\circ\eft}
  \\
\cobesys{Y}{\stesysf}{g}{p\circ\eft}
  \ar{r}[swap]{\pullbackpr{1}{g}{p\circ\eft}}
  &
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*} 
commutative. 
The process of obtaining the pre-extension algebra $\cobesys{Y}{\stesys}{g}{p}$ out of $\stesys$
and $g:Y\to X$ is also called the \emph{change of base}.
\end{defn}

\begin{lem}\label{cobesys-preext}
Any change of base of a pre-extension algebra is a pre-extension algebra.
\end{lem}

\begin{proof}
Let $\stesys$ be an extension algebra and consider $p:\stesysc\rightarrow X\leftarrow Y:g$.
We need to verify that the square
\begin{equation*}
\begin{tikzcd}[column sep=large]
(\pullback{Y}{\stesysf}{g}{p\circ\eft})_2
  \ar{r}{\cobesys{Y}{\efamext}{g}{p}} 
  \ar{d}[swap]{\pullbackpr{1}{\cobesys{Y}{\ectxext}{g}{p}}{g^\ast(\eft)}} 
  & 
\pullback{Y}{\stesysf}{g}{p\circ\eft}
  \ar{d}{g^\ast(\eft)}
  \\
\pullback{Y}{\stesysf}{g}{p\circ\eft}
  \ar{r}[swap]{g^\ast(\eft)} 
  & 
\pullback{Y}{\stesysc}{g}{p}
\end{tikzcd}
\end{equation*}
commutes. It is fairly obvious that
\begin{equation*}
\pullbackpr{1}{g}{p}\circ g^\ast(\eft)\circ (\cobesys{Y}{\efamext}{g}{p})
  =
\pullbackpr{1}{g}{p\circ\eft}\circ \pullbackpr{1}{\cobesys{Y}{\ectxext}{g}{p}}{g^\ast(\eft)}
\end{equation*}
and that the diagram
\begin{equation*}
\begin{tikzcd}
  {}&
  {}&
\pullback{Y}{\stesysf}{g}{p\circ\eft}
  \ar{rr}{g^\ast(\eft)}
  \ar{dr}[swap]{\pullbackpr{2}{g}{p\circ\eft}}
  &
  {}&
\pullback{Y}{\stesysc}{g}{p}
  \ar{ddr}{\pullbackpr{2}{g}{p}}
  \\
  {}&
  {}&
  {}&
\stesysf
  \ar{drr}[swap]{\eft}
  \\
(\pullback{y}{\stesysf}{g}{p\circ\eft})_2
  \ar{uurr}{\cobesys{Y}{\efamext}{g}{p}}
  \ar{rr}[swap,yshift=-.5ex]{\pullback{\pullbackpr{2}{g}{p\circ\eft}}{\pullbackpr{2}{g}{p\circ\eft}}{\ectxext}{\eft}}
  \ar{ddrr}[swap]{\pullbackpr{1}{\cobesys{Y}{\ectxext}{g}{p}}{g^\ast(\eft)}}
  &
  {}&
\stesysf_2
  \ar{ur}{\efamext}
  \ar{dr}[swap]{\eft[2]}
  &
  {}&
  {}&
\stesysc
  \\
  {}&
  {}&
  {}&
\stesysf
  \ar{urr}{\eft}
  \\
  {}&
  {}&
\pullback{Y}{\stesysf}{g}{p\circ\eft}
  \ar{rr}[swap]{g^\ast(\eft)}
  \ar{ur}{\pullbackpr{2}{g}{p\circ\eft}}
  &
  {}&
\pullback{Y}{\stesysc}{g}{p}
  \ar{uur}[swap]{\pullbackpr{2}{g}{p}}
\end{tikzcd}
\end{equation*}
commutes.
\end{proof}

\begin{thm}\label{cobesys-ext}
The change of base of an extension algebra is an extension algebra.
\end{thm}

\begin{proof}
Our first subgoal is to verify that the square
\begin{equation*}
\begin{tikzcd}[column sep=large]
(\pullback{Y}{\stesysf}{g}{p\circ\eft})_2
  \ar{r}{\cobesys{Y}{\efamext}{g}{p}} 
  \ar{d}[swap]{\pullbackpr{2}{\cobesys{Y}{\ectxext}{g}{p}}{g^\ast(\eft)}} 
  & 
\pullback{Y}{\stesysf}{g}{p\circ\eft}
  \ar{d}{\cobesys{Y}{\ectxext}{g}{p}}
  \\
\pullback{Y}{\stesysf}{g}{p\circ\eft}
  \ar{r}[swap]{\cobesys{Y}{\ectxext}{g}{p}} 
  & 
\pullback{Y}{\stesysc}{g}{p}
\end{tikzcd}
\end{equation*}
\end{proof}

The following construction is useful for defining extension homomorphisms into
`higher' extension algebras

\begin{defn}\label{cobesys-existence}
Consider a commutative diagram
\begin{equation*}
\begin{tikzcd}
\stesys'
  \ar{r}{f}
  \ar{d}[swap]{p'}
  &
\stesys
  \ar{d}{p}
  \\
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*}
Then we construct $[p,f]:\stesys'\to\cobesys{Y}{\stesys}{g}{p}$
\begin{itemize}
\item by defining $[p,f]_0:\stesysc'\to\pullback{Y}{\stesysc}{g}{p}$ be the uniqe
morphism rendering the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\stesysc'
  \ar[bend right=10]{ddr}[swap]{p'}
  \ar[bend left=10]{rrd}{f_0}
  \ar{dr}[near end]{[p,f]_0}
  \\
  {}&
\pullback{Y}{\stesysc}{g}{p}
  \ar{r}[swap]{\pullbackpr{2}{g}{p}}
  \ar{d}{\pullbackpr{1}{g}{p}}
  &
\stesysc
  \ar{d}{p}
  \\
  {}&
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*}
commutative.
\item by defining $[p,f]_1:\stesysf'\to\pullback{Y}{\stesysf}{g}{p\circ\eft}$ be the uniqe
morphism rendering the diagram
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\stesysf'
  \ar[bend right=10]{ddr}[swap]{p'\circ\eft'}
  \ar[bend left=10]{rrd}{f_1}
  \ar{dr}[near end]{[p,f]_1}
  \\
  {}&
\pullback{Y}{\stesysf}{g}{p\circ\eft}
  \ar{r}[swap]{\pullbackpr{2}{g}{p\circ\eft}}
  \ar{d}{\pullbackpr{1}{g}{p\circ\eft}}
  &
\stesysc
  \ar{d}{p\circ\eft}
  \\
  {}&
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*}
commutative.
\item by defining $[p,f]^t:\stesyst'\to\pullback{Y}{\stesyst}{g}{p\circ\eft\circ\ebd}$ be the uniqe
morphism rendering the diagram
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\stesyst'
  \ar[bend right=10]{ddr}[swap]{p'\circ\eft'\circ\ebd'}
  \ar[bend left=10]{rrd}{f^t}
  \ar{dr}[near end]{[p,f]^t}
  \\
  {}&
\pullback{Y}{\stesysf}{g}{p\circ\eft\circ\ebd}
  \ar{r}[swap]{\pullbackpr{2}{g}{p\circ\eft\circ\ebd}}
  \ar{d}{\pullbackpr{1}{g}{p\circ\eft\circ\ebd}}
  &
\stesysc
  \ar{d}{p\circ\eft\circ\ebd}
  \\
  {}&
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*}
commutative.
\end{itemize}
\end{defn}

\begin{thm}\label{cobesys-pullback}
For every diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\stesys'
  \ar[bend right=10]{ddr}[swap]{p'}
  \ar[bend left=10]{rrd}{f}
  \ar[dotted]{dr}[near end]{[p',f]}
  \\
  {}&
\cobesys{Y}{\stesys}{g}{p}
  \ar{d}{\pullbackpr{1}{g}{p}}
  \ar{r}[swap]{\pullbackpr{2}{g}{p}}
  &
\stesys
  \ar{d}{p}
  \\
  {}&
Y \ar{r}[swap]{g}
  &
X
\end{tikzcd}
\end{equation*}
of which the outer square commutes, the pre-extension homomorphism $[p',f]$
is unique with the property that it renders the whole diagram commutative.
\end{thm}

\begin{defn}\label{famfamstesys_into}
Consider a commutative square
\begin{equation*}
\begin{tikzcd}
\stesys'
  \ar{r}{f}
  \ar{d}[swap]{p}
  &
\famesys\stesys
  \ar{d}{\eft}
  \\
\stesysf \ar{r}[swap]{\ectxext}
  &
\stesysc
\end{tikzcd}
\end{equation*}
Then we construct
\begin{equation*}
[p,f]:\stesys'\to\famesys{\famesys{\stesys}}
\end{equation*}
as follows:
\begin{itemize}
\item let $[p,f]_0:\stesysc'\to\stesysf_2$ be the unique morphism rendering
the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\stesysc' 
  \ar[bend left=10]{rrd}{f_0}
  \ar[swap,bend right=10]{ddr}{p}
  \ar[dotted]{dr}[near end]{[p,f]_0}
  \\
  {}&
\stesysf_2
  \ar{r}[swap]{\pullbackpr{2}{\ectxext}{\eft}}
  \ar{d}{\eft[2]}
  &
\stesysf
  \ar{d}{\eft}
  \\
  {}&
\stesysf
  \ar{r}[swap]{\ectxext}
  &
\stesysc
\end{tikzcd}
\end{equation*}
commutative.
\item Let $[p,f]_1:\stesysf'\to\stesysf_3$ be the unique morphism rendering
the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\stesysf'
  \ar[bend left=10]{drr}{f_1}
  \ar[swap]{dd}{\eft'}
  \ar[dotted]{dr}[near end]{[p,f]_1}
  \\
  {}&
\stesysf_3
  \ar{r}[swap]{\pullbackpr{2}{\efamext}{\eft[2]}}
  \ar{d}{\eft[2]}
  &
\stesysf_2
  \ar{d}{\eft[2]}
  \\
\stesysc'
  \ar{r}[swap]{[p,f]_0}
  &
\stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutative.
\item Let $[p,f]^t:\stesyst'\to\stesyst_3$ be the unique morphism rendering
the diagram
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\stesyst'
  \ar[bend left=10]{drr}{f^t}
  \ar[swap]{dd}{\eft'\circ\ebd'}
  \ar[dotted]{dr}[near end]{[p,f]^t}
  \\
  {}&
\stesyst_3
  \ar{r}[swap]{\pullbackpr{2}{\efamext}{\eft[2]\circ\ebd[2]}}
  \ar{d}[swap]{\pullbackpr{1}{\efamext}{\eft[2]\circ\ebd[2]}}
  &
\stesyst_2
  \ar{d}{\eft[2]\circ\ebd[2]}
  \\
\stesysc'
  \ar{r}[swap]{[p,f]_0}
  &
\stesysf_2
  \ar{r}[swap]{\efamext}
  &
\stesysf
\end{tikzcd}
\end{equation*}
commutative.
\end{itemize}
\end{defn}

\begin{lem}
Under the hypotheses of \autoref{famfamstesys_into}, $[p,f]$ is a pre-extension
homomorphism. Moreover, it is the unique pre-extension homomorphism for which
the diagram
\begin{equation*}
\begin{tikzcd}[column sep=large]
\stesys' 
  \ar[bend left=10]{rrd}{f}
  \ar[swap,bend right=10]{ddr}{p}
  \ar[dotted]{dr}[near end]{[p,f]}
  \\
  {}&
\famesys{\famesys{\stesys}}
  \ar{r}[swap]{\pullbackpr{2}{\ectxext}{\eft}}
  \ar{d}{\eft[2]}
  &
\famesys{\stesys}
  \ar{d}{\eft}
  \\
  {}&
\stesysf
  \ar{r}[swap]{\ectxext}
  &
\stesysc
\end{tikzcd}
\end{equation*}
commutes.
\end{lem}

\begin{lem}
Suppose $f:\stesys\to \stesys'$ is a pre-extension homomorphism and consider a morphism
$p:\stesys'\to X$ and $g:Y\to X$. Then the change of base 
$g^\ast(f):\cobesys{Y}{\stesys}{g}{p\circ f_0}\to
\cobesys{Y}{\stesys'}{g}{p}$ is a pre-extension morphism.
\end{lem}

\begin{lem}
Let $\stesys$ be a pre-extension algebra and consider $p:\stesysc\rightarrow X\leftarrow Y:g$.
Then there is an isomorphism
\begin{equation*}
\varphi:\famesys{\cobesys{Y}{\stesys}{g}{p}}
  \simeq
\cobesys{Y}{\famesys{\stesys}}{g}{p\circ\eft}
\end{equation*}
uniquely determined by
\end{lem}

\begin{proof}
This follows from the pasting lemma for pullbacks.
\end{proof}
