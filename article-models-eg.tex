\section{Empirical evidence of what an internal model should be}

\subsection{Univalent universes as internal models}

Before we give the definition we illustrate the concepts that go into it in
the case of a univalent universe $\UU$.
Regardless of the definition of an internal model, a univalent universe should
be an example of one.

The type of contexts is $\UU$ itself and for every $\Gamma:\UU$, a type in
context $\Gamma$ is simply a family $A:\Gamma\to\UU$. The type $\terms{A}$ of terms of a type $A$
in context $\Gamma$ is defined to be $\prd{i:\Gamma}A(i)$. Note that $\Gamma\to
\UU$ itself also interprets type theory where a type in context $A:\Gamma\to\UU$
is a family $P:(\sm{i:\Gamma}A(i))\to\UU$. We may denote this model by
$\mftyp{\UU}{\Gamma}$. The terms of a type $P$ in context $A$ in the model
$\Gamma\to\UU$ are the terms of $\prd{i:\Gamma}{x:A(i)}P(i,x)$.

When $A$ is a type in context
$\Gamma$ we define the context extension $\ctxext{\Gamma}A$ to be
$\sm{i:\Gamma}A(i)$. Note that context extension $\ctxext{\Gamma}\blank$
can be seen acting not only as a function from the context of the model
$\Gamma\to\UU$ to the context of the model $\UU$, but it also acts on the types 
and terms: when $A$ is a type in context $\Gamma$ we may take the identity map
from $\mftyp{\Gamma\to\UU}{A}\to\mftyp{\UU}{\ctxext{\Gamma}A}$ because
$\mftyp{\Gamma\to\UU}{A}$ is taken to be $\mftyp{\UU}{\ctxext{\Gamma}A}$;
thus, $\ctxext{\Gamma}P\defeq P$ for every family $P$ over $A$ in context 
$\Gamma$. Likewise, when $P$ is a type in context $A$ in the model 
$\Gamma\to\UU$ then context extension should act on the terms of $P$ via a
function $\terms{P}\to\terms{\ctxext{\Gamma}P}$, which we take to be
the identity map once more.

Since $\mftyp{\UU}{\Gamma}$ is a model of type theory it
has it's own notion of context extension: when $P$ is a type in context $A$ in
the model $\mftyp{\UU}{\Gamma}$ then $\ctxext{A}P$ is the family
$\lam{i}\sm{x:A(i)}P(i,x):\Gamma\to\UU$. Also the context extension of
$\Gamma\to\UU$ acts trivially on the types and terms. Context extension is
analoguous to the Grothendieck construction that associates the category of
elements to a presheaf and it gives us $\Sigma$-types.

When $A$ and $B$ are types in context
$\Gamma$, the weakening $\ctxwk{A}{B}$ of $B$ along $A$ is defined to be
$\lam{\pairr{i,x}}B(i):(\sm{i:\Gamma}A(i))\to\UU$. Weakening along a type $A$ 
in context $\Gamma$ also acts on types and terms. When $Q$ is a type in context
$B$ in the model $\Gamma\to\UU$, we define $\ctxwk{A}{Q}$ to be 
$\lam{\pairr{i,x}}{y}Q(i,y)$. When $g:\terms{Q}$ we define $\ctxwk{A}{g}$ to
be $\lam{\pairr{i,x}}{y}g(i,y)$.

Note that for two types $A$ and $B$ in context $\Gamma$, the terms of
$\ctxwk{A}{B}$ are the terms of $\prd{i:\Gamma}A(i)\to B(i)$, i.e.~they are
the fiberwise maps from $A$ to $B$. We shall take the type $\terms{\ctxwk{A}{B}}$
of terms of $\ctxwk{A}{B}$ to be the type of morphisms from $A$ to $B$. Also,
any context of $\UU$ may be seen as a type in the empty context $\unit$. Thus
the type of terms of a context $\Gamma$ is $\unit\to\Gamma$, which is
equivalent to $\Gamma$. A context morphism from $\Delta$ to $\Gamma$ is a term
of $\ctxwk{\Gamma}{\Delta}$, i.e.~a function from $\Gamma$ to $\Delta$. We denote
the type $\terms{\ctxwk{\Gamma}{\Delta}}$ by $\ctxhom{\Delta}{\Gamma}$. 

When $P$ is a family over
$A$ in context $\Gamma$ and $x$ is a term of $A$ we define the type $\subst{x}{P}$
in context $\Gamma$ to be $\lam{i}P(i,x(i))$. Like extension 

We will interpret the dependent product $\mprd{A}{P}$ of a family $P$ over
$A$ in context $\Gamma$ by
\begin{equation*}
\mprd{A}{P}(i)\defeq \prd{x:A(i)}P(i,x)
\end{equation*}
With this interpretation there is an equivalence 
$\lambda:\eqv{\terms{P}}{\terms{\mprd{A}{P}}}$. This is lambda-abstraction; its
inverse being evaluation. We should note however, that the rule for evaluation
we interpret here is
\begin{equation*}
\inference{\Gamma\vdash f:\mprd{A}{P}}{\ctxext{\Gamma}A\vdash\tfev(f):P}
\end{equation*}
which is different than the usual rule
\begin{equation*}
\inference{\Gamma\vdash f:\mprd{A}{P} \qquad \Gamma\vdash a:A}{\Gamma \vdash \tfev(f,a):\subst{a}{P}}
\end{equation*}
The reason for this is that the interpretation of the usual rule would give a
function of type $\terms{\mprd{A}{P}}\to\prd{x:\terms{A}}\terms{\subst{x}{P}}$,
but this does not describe the terms of $\mprd{A}{P}$ by any means. Moreover,
since we have implemented substitution, we obtain from $\ctxext{\Gamma}A\vdash\tfev(f):P$ 
and $\Gamma\vdash x:A$ a term $\Gamma\vdash\subst{x}{\tfev(f)}:\subst{x}{P}$ and
therefore we do not loose anything with this approach.

{\color{red} point to example}

\subsection{The Sierpinsky model}.
In the Sierpinsky model, contexts are interpreted by dependent types $A\to\type$.

\subsection{The graph model of type theory}
In this section we define the graph model of type theory, denoted by
$\mfGraph$.  In our presentation, we follow that of the definition internal
models. After we have established the graph model, we show how the graph
model can be seen as a presheaf model, namely over the category $\cdot
{\rightrightarrows}\cdot$.

\begin{defn}
A \emph{(directed) graph} $\Gamma$ is a pair $\pairr{\Gamma_0,\Gamma_1}$ 
consisting of a type $\Gamma_0$ of vertices and a family 
$\Gamma_1:\Gamma_0\to\Gamma_0\to\type$ of edges. The type $\ctx(\mfGraph)$
is defined to be the type of all graphs; we will usually denote it by
$\tfGraph$. Explicitly, we have
\begin{equation*}
\tfGraph\defeq\sm{\Gamma_0:\type}\Gamma_0\to\Gamma_0\to\type.
\end{equation*}
\end{defn}

\begin{eg}\label{ex:pb}
The underlying graph of the diagram
\begin{equation*}
\begin{tikzcd}
{} & A \ar{d}{f} \\
B \ar{r}[swap]{g} & C
\end{tikzcd}
\begin{comment}
\begin{tikzpicture}
\matrix (m) [std] { & A \\ B & C \\};
\draw[ar] (m-1-2) -- node[right] {$f$} (m-2-2);
\draw[ar] (m-2-1) -- node[below] {$g$} (m-2-2);
\end{tikzpicture}
\end{comment}
\end{equation*}
is $I\defeq\mathbf{3}$ and has $J(1,3)\defeq J(2,3)\defeq \unit $ 
and $J(x,y)\defeq\emptyt$ otherwise (it is defined using the induction 
principle of $\mathbf{3}$ and a universe).
\end{eg}


\begin{defn}
A \emph{graph $A$ in the context $\Gamma$} is a pair $\pairr{A_0,A_1}$ consisting
of 
\begin{align*}
A_0 & :\Gamma_0\to\type\\
A_1 & :\prd*{i,j:\Gamma_0}\Gamma_1(i,j)\to A_0(i)\to A_0(j)\to\type.
\end{align*}
Thus, for a graph $\Gamma$, the type $\mftyp{\mfGraph}{\Gamma}$ is the type
\begin{equation*}
\sm{A_0:\Gamma_0\to\type}\prd*{i,j:\Gamma_0}\Gamma_1(i,j)\to A_0(i)\to A_0(j)\to\type.
\end{equation*}
We will also write $\Gamma\vdash A:\mfGraph$ when $A$ is a graph in context
$\Gamma$.
\end{defn}

\begin{defn}
Suppose that $\Gamma\vdash A:\mfGraph$. Then we define the graph $\ctxext{\Gamma}A$
by
\begin{align*}
\ctxext{\Gamma}A_0 & \defeq \sm{i:\Gamma_0}A_0(i)\\
\ctxext{\Gamma}A_1(\pairr{i,x},\pairr{j,y}) & \defeq \sm{q:\Gamma_1(i,j)}A_1(q,x,y).
\end{align*}
\end{defn}

\begin{defn}
Suppose that $\Gamma\vdash A:\mfGraph$ and $\Gamma\vdash B:\mfGraph$. Then we
define the graph $\ctxwk{A}{B}$ in context $\ctxext{\Gamma}A$ by
\begin{align*}
(\ctxwk{A}{B})_0(\pairr{i,x}) & \defeq B_0(i)\\
(\ctxwk{A}{B})_1(\pairr{q,e},u,v) & \defeq B_1(q,u,v).
\end{align*}
\end{defn}

\begin{defn}
Suppose that $\Gamma\vdash A:\mfGraph$. A term $x$ of $A$ consists of a pair
$\pairr{x_0,x_1}$ where
\begin{align*}
x_0 & : \prd{i:\Gamma_0}A_0(i)\\
x_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1}A_1(q,x_0(i),x_0(j)).
\end{align*}
Thus we define
\begin{equation*}
\terms{A}\defeq\sm{x_0:\prd{i:\Gamma_0}A_0(i)}\prd*{i,j:\Gamma_0}{q:\Gamma_1}A_1(q,x_0(i),x_0(j)).
\end{equation*}
We also write $\Gamma\vdash x:A$ when $x$ is a term of the graph $A$ in context
$\Gamma$.
\end{defn}

\begin{defn}
Suppose that $P$ is a family of graphs over $A$ in context $\Gamma$ and let
$x$ be a term of $A$. Then we define the graph $\subst{x}{P}$ 
in context $\Gamma$ by
\begin{align*}
\subst{x}{P}_0(i) & \defeq P_0(\pairr{i,x_0(i)})\\
\subst{x}{P}_1(q,u,v) & \defeq P_1(\pairr{q,x_1(q)},u,v)
\end{align*}
\end{defn}

\begin{rmk}
Note that we have the judgmental equality $\subst{x}{\ctxwk{A}{B}}\jdeq B$
for every two graphs $A$ and $B$ in context $\Gamma$ and every term $x$ of $A$.
\end{rmk}

\begin{defn}
The terminal graph $\unit^\mfGraph$, which we shall often denote simply 
by $\unit$, is defined by
\begin{align*}
{\unit^\mfGraph}_0 & \defeq \unit\\
{\unit^\mfGraph}_1(x,y) & \defeq \unit.
\end{align*}
\end{defn}

\begin{rmk}
We note that the function $\ctxext{\unit}\blank$ is an equivalence
from $\mftyp{\mfGraph}{\unit}$ to $\tfGraph$. It's inverse is the function which maps
a graph $\Gamma$ to the pair $\pairr{A_0,A_1}$ where $A_0$ is defined by
$A_0(\ttt)\defeq\Gamma_0$ and where $A_1$ is defined by $A_1(\ttt)\defeq
\Gamma_1$. 

Note that we only have an equivalence here, not a judgmental equality.
\end{rmk}

\subsubsection{The contexts of $\mfGraph$}


The category $\psh(\cdot{\rightrightarrows}\cdot)$ of presheaves over
$\cdot{\rightrightarrows}\cdot$ is given by
\begin{equation*}
\sm{A_0,A_1:\type}(A_1\to A_0)\times(A_1\to A_0).
\end{equation*}
To see that $\psh(\cdot{\rightrightarrows}\cdot)$ is indeed equivalent to
the type $\tfGraph$ of all graphs, note that we have the equivalences
\begin{align*}
\psh(\cdot{\rightrightarrows}\cdot) & \eqvsym \sm{A_0,A_1:\type}A_1\to A_0\times A_0\\
& \eqvsym \sm{A_0:\type} A_0\times A_0\to\type\\
& \eqvsym \tfGraph.
\end{align*}

\begin{defn}
Suppose that $\Delta\defeq \pairr{\Delta_0,\Delta_1}$ and $\Gamma\defeq \pairr{\Gamma_0,
\Gamma_1}$ are graphs. A morphism $f$ from $\Delta$ to $\Gamma$ is a pair
$\pairr{f_0,f_1}$ consisting of
\begin{align*}
f_0 & : \Delta_0\to\Gamma_0\\
f_1 & : \prd*{u,v:\Delta_0}\Delta_1(u,v)\to\Gamma_1(f_0(u),f_0(v))
\end{align*}
We write $\ctxhom{\Delta}{\Gamma}$ for the type of morphisms of graphs.
\end{defn}

The terminal graph $\unit^\mfGraph$ plays the role of the empty context.

\begin{defn}
The terminal graph $\unit^\mfGraph$, which we shall often denote simply 
by $\unit$, is defined by
\begin{align*}
{\unit^\mfGraph}_0 & \defeq \unit\\
{\unit^\mfGraph}_1(x,y) & \defeq \unit.
\end{align*}
\end{defn}

It is immediate that the type of graph morphisms $\Gamma\to\unit^\mfGraph$ is
contractible for every graph $\Gamma$. The terms of a graph $\Gamma$ are the
global elements of $\Gamma$, i.e.~they are the morphisms of type 
$\ctxhom{\unit^\mfGraph}{\Gamma}$.

\begin{defn}
Let $\Gamma$ be a graph. The type $\terms[\mfGraph]{\Gamma}$ of terms of $\Gamma$ is
defined to be
\begin{equation*}
\sm{x_0:\Gamma_0}\Gamma_1(x_0,x_0).
\end{equation*}
\end{defn}

We now turn to the description of the universe $\gobjclass$ of graphs. Note
that for the category $I\defeq 0{\rightrightarrows}1$, we have
$I/0\defeq\catid{0}$ and $I/1\defeq s\rightarrow\catid{1}\leftarrow t$, where
$s$ and $t$ are the morphisms $0\to 1$. Thus we have 
\begin{align*}
\psh(I/0) & \eqvsym \type\\
\psh(I/1) & \eqvsym \sm{X,Y:\type}X\to Y\to\type.
\end{align*}
The functors $\psh(\Sigma_s)$ and $\psh(\Sigma_t)$ map a presheaf 
$\pairr{X,Y,R}$ to $X$ and $Y$, respectively. 
Thus we obtain the following graph $\gobjclass$.

\begin{defn}
The universe $\gobjclass$ of graphs is defined to be
\begin{align*}
{\gobjclass}_0 & \defeq \type\\
{\gobjclass}_1(X,Y) & \defeq X\to Y\to\type.
\end{align*}
\end{defn}

Note that the type $\terms{\gobjclass}$ of terms of $\gobjclass$ is 
exactly $\tfGraph$. 

\subsubsection{Families of graphs}
Using $\gobjclass$, we obtain a description of what
it means to be a graph in a context $\Gamma$, where $\Gamma$ is itself a
graph. The notion of ``a graph in a context $\Gamma$'' is the interpretation
of ``a type in a context $\Gamma$''.

\begin{defn}
A \emph{graph $A$ in the context $\Gamma$} is a pair $\pairr{A_0,A_1}$ consisting
of 
\begin{align*}
A_0 & :\Gamma_0\to\type\\
A_1 & :\prd*{i,j:\Gamma_0}\Gamma_1(i,j)\to A_0(i)\to A_0(j)\to\type.
\end{align*}
We will also write $\Gamma\vdash A:\mfGraph$ when $A$ is a graph in context
$\Gamma$.
\end{defn}

\begin{rmk}
Note that every graph can be seen as a graph in context $\unit^\mfGraph$.
\end{rmk}

\begin{defn}
Let $A$ be a graph in context $\Gamma$ and let $f:\ctxhom{\Delta}{\Gamma}$
be a graph morphism. We define the graph $A[f]$ in context $\Delta$ by
\begin{align*}
A[f]_0(u) & \defeq A_0(f_0(u))\\
A[f]_1(p,x,y) & \defeq A_1(f_1(p),x,y).
\end{align*}
\end{defn}

\begin{defn}
Let $\Gamma\vdash A:\mfGraph$ and $\Gamma\vdash B:\mfGraph$ be two graphs in
the context $\Gamma$. A morphism $f$ from $A$ to $B$ is a pair $\pairr{f_0,f_1}$
consisting of
\begin{align*}
f_0 & : \prd*{i:\Gamma_0} A_0(i)\to B_0(i)\\
f_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_0}*{x:A_0(i)}*{y:A_0{j}}A_1(q,x,y)\to B_1(q,f_0(x),f_0(y)).
\end{align*}
We write $\ctxhom[\Gamma]{A}{B}$ for the type of morphisms between graphs in
context $\Gamma$.
\end{defn}

\begin{defn}
The unit graph $\unit^\Gamma$ in context $\Gamma$ consists of
\begin{align*}
(\unit^\Gamma)_0 & \defeq \lam{i}\unit\\
(\unit^\Gamma)_1(q) & \defeq \lam{x}{y}\unit.
\end{align*}
\end{defn}

As was the case with graphs, terms of graphs in a context are described by
morphisms from $\unit$. Explicating this in more detail, we get

\begin{defn}
Let $A$ be a graph in context $\Gamma$. A term $x$ of $A$ is a pair
$\pairr{x_0,x_1}$ consisting of
\begin{align*}
x_0 & : \prd{i:\Gamma_0}A_0(i)\\
x_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)}A_1(q,x_0(i),x_0(j)).
\end{align*}
We define $\terms[\mfGraph]{A}$ to be the type of terms of $A$.
\end{defn}

\begin{rmk}
Note that the type of terms of a graph $\Gamma$ is equivalent to the type
of terms of the graph $\Gamma$ in context $\unit^\mfGraph$.
\end{rmk}

\begin{defn}
Suppose that $\Gamma\vdash A:\mfGraph$. Then we define the graph $\ctxext{\Gamma}A$
by
\begin{align*}
(\ctxext{\Gamma}A)_0 & \defeq \sm{i:\Gamma_0}A_0(i)\\
(\ctxext{\Gamma}A)_1(\pairr{i,x},\pairr{j,y}) & \defeq \sm{q:\Gamma_1(i,j)}A_1(q,x,y).
\end{align*}
There is a morphism $\pi^A:\ctxhom{\ctxext{\Gamma}A,\Gamma}$ given by
\begin{align*}
\pi^A_0 & \defeq \lam{\pairr{i,x}}i && : (\sm{i:\Gamma_0}A_0(i))\to \Gamma_0\\
\pi^A_1(\pairr{i,x},\pairr{j,y}) & \defeq \lam{\pairr{q,e}}q && : (\sm{q:\Gamma_1(i,j)}A_1(q,x,y))\to\Gamma_1(i,j).
\end{align*}
\end{defn}

\begin{rmk}
The construction of $\ctxext{\Gamma}A$ is similar to the Grothendieck
construction of the category of elements for a presheaf.
\end{rmk}

\begin{defn}
Let $\Gamma\vdash A:\mfGraph$. A family $P$ of graphs over $A$ is by
definition a graph $P$ in the context $\ctxext{\Gamma}A$. More explicitly, a family
$P$ of graphs over $A$ in context $\Gamma$ consists of
\begin{align*}
P_0 & : \prd*{i:\Gamma_0}A_0(i)\to\type\\
P_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)}*{x:A_0(i)}*{y:A_0(j)} A_1(q,x,y)\to P_0(x)\to P_0(y)\to\type
%P_1 & : \prd{\pairr{i,x},\pairr{j,y}:(\ctxext{\Gamma}A)_0}(\ctxext{\Gamma}A)_1(\pairr{i,x},\pairr{j,y})\to P_0(i,x)\to P_0(j,y)\to\type.
\end{align*}
\end{defn}

\begin{defn}
When $P$ is a family of graphs over $A$ in context $\Gamma$ and $x:A$, we
get a graph $\subst{x}{P}$ in context $\Gamma$ given by
\begin{align*}
\subst{x}{P}_0(i) & \defeq P_0(x_0(i))\\
\subst{x}{P}_1(q,u,v) & \defeq P_1(\pairr{q,x_1(q)},u,v)
\end{align*}
\end{defn}

\subsubsection{The basic type constructors for graphs}
With families of graphs being available, we can give the interpretations of
dependent products, dependent sums and identity types. In the following, we
shall introduce the graph interpretations of dependent products, dependent
sums and identity types and describe the terms of the resulting graphs.\note{These definitions
should be connected to Mike's article but I don't really know how to do this}

\begin{defn}
Let $P$ be a family of graphs over $A$, where $\Gamma\vdash A:\mfGraph$. 
The dependent function graph $\mprd{A}{P}$ in context $\Gamma$ consists of
\begin{align*}
\mprd{A}{P}_0(i) & \defeq \prd{x:A_0(i)}P_0(x)\\
\mprd{A}{P}_1(q,f,g) & \defeq \prd*{x:A_0(i)}*{y:A_0(j)}{e:A_1(q,x,y)}P_1(\pairr{q,e},f(x),g(y)).
\end{align*}
\end{defn}

\begin{rmk}
A term $f:\mprd{A}{P}$ consists of
\begin{align*}
f_0 & : \prd*{i:\Gamma_0}{x:A_0(i)}P_0(x)\\
f_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)}*{x:A_0(i)}*{y:A_0(j)}{e:A_1(q,x,y)}P_1(\pairr{q,e},f_0(x),f_0(y))
\end{align*}
Therefore, we see that $\eqv{\terms{\mprd{A}{P}}}{\terms{P}}$. \emph{Warning:} it
is by no means the case that $\eqv{\terms{\mprd{A}{P}}}{\prd{x:\terms{A}}
\terms{\subst{x}{P}}}$ for all families $P$ over $A$. For instance, the graph
$\tilde{\emptyt}$ defined by $\tilde{\emptyt}_0\defeq\unit$ and 
$\tilde{\emptyt}_1(\ttt,\ttt)\defeq\emptyt$ has no terms and neither does
$\tilde{\emptyt}+\tilde{\emptyt}$. Nevertheless, there are two graph morphisms
from $\tilde{\emptyt}$ to $\tilde{\emptyt}+\tilde{\emptyt}$. More generally,
when $\Gamma$ is a graph such that $\Gamma_1(i,j)\jdeq\emptyt$ for all $i,j:\Gamma_0$,
then $\eqv{{\terms{\Gamma\to\Gamma'}}}{\Gamma_0\to\Gamma^\prime_0}$.
\end{rmk}

\begin{defn}
If $P$ is a family of graphs over $\Gamma$, the dependent pair graph
$\msm{A}{P}$ consists of
\begin{align*}
\msm{A}{P}_0(i) & \defeq \sm{x:A_0(i)}P_0(x)\\
\msm{A}{P}_1(q,\pairr{x,u},\pairr{y,v}) & \defeq \sm{e:A_1(q,x,y)}P_1(\pairr{q,e},u,v).
\end{align*}
\end{defn}

\begin{rmk}
A term $w:\msm{A}{P}$ consists of
\begin{align*}
w_0 & : \prd{i:\Gamma_0}\sm{x:A_0(i)}P_0(x)
\intertext{and, writing $\lam{i}\proj1(w_0(i))$ and $\lam{i}\proj2(w_0(i))$ as
$w_{00}$ and $w_{01}$ respectively,}
w_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)}\sm{e:A_1(q,w_{00}(i),w_{00}(j)}P_1(\pairr{q,e},w_{01}(i),w_{01}(j)).
\end{align*}
By $\choice{\infty}$ it follows that
\begin{equation*}
\eqv{\terms{\msm{A}{P}}}{\sm{x:\terms{A}}\terms{\subst{x}{P}}}.
\end{equation*}
\end{rmk}

\begin{rmk}
For any two graphs $A$ and $B$ in a context $\Gamma$, we have the graph
$B[\pi^A]$ in the context $\ctxext{\Gamma}A$, which we may just write
as $B$. Therefore, we can
consider the graphs $\mprd{A}{B}$ and $\msm{A}{B}$. As usually those shall be
denoted  by $A\to B$ and $A\times B$, respectively. 

A term $f$ of $A\to B$ consists of
\begin{align*}
f_0 & : \prd*{i:\Gamma_0}A_0(i)\to B_0(i)\\
f_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)}*{x:A_0(i)}*{y:A_0(j)}A_1(q,x,y)\to B_1(q,f_0(x),f_0(y)),
\end{align*}
so we see that $\terms{A\to B}\jdeq\ctxhom[\Gamma]{A}{B}\jdeq\terms{B[\pi^A]}$. 

A term $\pairr{x,y}$ of $A\times B$ consists of
\begin{align*}
\pairr{x,y}_0 & : \prd*{i:\Gamma_0} A_0(i)\times B_0(i)\\
\pairr{x,y}_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)} A_1(q,x_0(i),x_0(j))\times B_1(q,y_0(i),y_0(j))
\end{align*}
so we see that $\eqv{\terms{A\times B}}{\terms{A}\times\terms{B}}$. 

Note that we also obtain
a \emph{graph} $\Delta\to\Gamma$ this way, for every two graphs $\Delta$ and
$\Gamma$ seen as graphs in the context $\unit^\mfGraph$. 
The type $\terms{\Delta\to\Gamma}$ of terms of $\Delta\to\Gamma$ is just
$\ctxhom{\Delta}{\Gamma}$.
\end{rmk}

\begin{defn}
For any graph $\Gamma$ there is a graph $\tffam{\Gamma}$ in context 
$\gobjclass$ defined by
\begin{align*}
(\tffam{\Gamma})_0 & \defeq \lam{X}X\to\Gamma_0\\
(\tffam{\Gamma})_1(X,Y,R) & \defeq \lam{f}{g}\prd*{x:X}*{y:Y}R(x,y)\to\Gamma_1(f(x),g(y)).
\end{align*}
\end{defn}

\begin{rmk}
A term $D$ of $\msm{\gobjclass}{\tffam{\Gamma}}$ consists of a term
$\pairr{\Delta_0,f_0}$ of type
\begin{equation*}
\msm{\gobjclass}{\tffam{\Gamma}}_0\jdeq \sm{\Delta_0:\type}\Delta_0\to\Gamma_0
\end{equation*}
and a term $\pairr{\Delta_1,f_1}$ of type
\begin{equation*}
\msm{\gobjclass}{\tffam{\Gamma}}_1(q)\jdeq \sm{\Delta_1}
\end{equation*}
\end{rmk}

\begin{defn}
There is a graph morphism
\begin{equation*}
\graphcharmapfunc{\Gamma} : \sm{\gobjclass}
\end{equation*}
\end{defn}

\begin{defn}
Let $A$ be a graph in context $\Gamma$. We define the family $\idtypevar{A}$ over $\ctxwk{A}{A}$ in
context $\ctxext{\Gamma}A$ by
\begin{align*}
(\idtypevar{A})_0(\pairr{i,x},y) & \defeq \id{x}{y}\\
(\idtypevar{A}){}_1(\pairr{q,e},d,\alpha,\alpha') & \defeq \id{\trans{\pairr{\alpha,\alpha'}}{e}}{d}
\end{align*}
where $q:\Gamma_1(i,j)$, $e:A_1(q,x,x')$, $d:A_1(q,y,y')$, $\alpha:\id{x}{y}$
and $\alpha':\id{x'}{y'}$. The transportation along the path 
$\pairr{\alpha,\alpha'}:\id{\pairr{x,x'}}{\pairr{y,y'}}$ in $A_0(i)\times A_0(j)$
is taken with respect to the family $\lam{x}{x'}A_1(q,x,x')$.

We define the term $\refl{A}$ of the family 
$\subst{\idfunc[A]}{\idtypevar{A}}$ over $A$ in context $\Gamma$ by
\begin{align*}
(\reflf{A})_0(i) & \defeq \lam{x}\refl{x}\\
(\reflf{A})_1(q) & \defeq \lam{e}\refl{e}
\end{align*}
\end{defn}

\begin{defn}
Let $D$ be a family over $\idtypevar{A}$ in context 
$\ctxext({\Gamma}{A})\ctxwk{A}{A}$. Then we have the family
$\subst{\idfunc[A]}{D}$ over $\subst{\idfunc[A]}{\idtypevar{A}}$ in
context $\ctxext{\Gamma}A$ given by
\begin{align*}
\subst{\idfunc[A]}{D}_0(\pairr{i,x},\alpha) & \defeq D_0(\pairr{i,x,x},\alpha)\\
\subst{\idfunc[A]}{D}_1(\pairr{q,e},\gamma) & \defeq D_1(\pairr{q,e,e},\gamma).
\end{align*}
The family $\subst{\reflf{A}}{\subst{\idfunc[A]}{D}}$ over $A$ in
context $\Gamma$ is given by
\begin{align*}
\subst{\reflf{A}}{\subst{\idfunc[A]}{D}}_0(i,x) & \defeq D_0(i,x,x,\refl{x})\\
\subst{\reflf{A}}{\subst{\idfunc[A]}{D}}_1(q,e) & \defeq D_1(q,e,e,\refl{e}).
\end{align*}
To show that the identity graphs correctly interpret the identity elimination
rule, we must give a function
\begin{equation*}
\tfJ : \terms{\subst{\reflf{A}}{\subst{\idfunc[A]}{D}}}\to\terms{D}.
\end{equation*}
Note that a term $d$ of $\subst{\reflf{A}}{\subst{\idfunc[A]}{D}}$
consists of
\begin{align*}
d_0 & : \prd*{i:\Gamma_0}{x:A_0(i)}D_0(i,x,x,\refl{x})\\
d_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)}*{x:A_0(i)}*{y:A_0(j)}{e:A_1(q,x,y)}D_1(q,e,e,\refl{e})
\end{align*}
A simple argument using path induction reveals that terms of
$\subst{\reflf{A}}{\subst{\idfunc[A]}{D}}$ indeed yield terms of $D$. 
\end{defn}

\begin{rmk}
Using the identity graph $\idtypevar{A}$ we can describe the identity
graph $\id[A]{x}{y}$ in context $\Gamma$ for any two terms $x,y:A$. 
The graph $\id[A]{x}{y}$ in context $\Gamma$ consists of
\begin{align*}
(\id[A]{x}{y})_0(i) & \defeq \id{x_0(i)}{y_0(i)}\\
(\id[A]{x}{y})_1(q,\alpha,\beta) & \defeq \id{\trans{\pairr{\alpha,\beta}}{x_1(q)}}{y_1(q)}
\end{align*}
From this, we see that a term of $p:\id[A]{x}{y}$ consists of
\begin{align*}
p_0 & : \prd{i:\Gamma_0}\id{x_0(i)}{y_0(i)}\\
p_1 & : \prd*{i,j:\Gamma_0}{q:\Gamma_1(i,j)}\id{\trans{\pairr{p_0(i),p_0(j)}}{x_1(q)}}{y_1(q)}.
\end{align*}
\end{rmk}

\subsubsection{Properties of graphs}

\subsubsection{Contractibility and equivalences of graphs}

\begin{defn}
A graph $A$ in context $\Gamma$ is said to be \emph{contractible} if there
is a term of the graph
\begin{equation*}
\msm{A}{\mprd{\ctxwk{A}{A}}{\idtypevar{A}}}
\end{equation*}
in context $\Gamma$.
\end{defn}

\begin{lem}\label{lem:contractible-graphs}
Let $A$ be a graph in context $\Gamma$. The following are equivalent:
\begin{enumerate}
\item $A$ is a contractible graph.
\item Both $A_0(i)$ and $A_1(q,x,y)$ are always contractible.
\end{enumerate}
\end{lem}

\begin{proof}
Let $H:\msm{A}{\mprd{\ctxwk{A}{A}}{\idtypevar{A}}}$. Unfolding the definitions, we have
an element $H_0(i)$ of type
\begin{align*}
\msm{A}{\mprd{\ctxwk{A}{A}}{\idtypevar{A}}}_0(i) & \jdeq \sm{x:A_0(i)}\mprd{\ctxwk{A}{A}}{\idtypevar{A}}_0(i,x)\\
& \jdeq \sm{x:A_0(i)}\prd{y:A_0(i)}(\idtypevar{A})_0(\pairr{i,x},y)\\
& \jdeq \sm{x:A_0(i)}\prd{y:A_0(i)}\id{x}{y}
\end{align*}
for all $i:\Gamma_0$ and, writing $H_{00}(i)$ for $\proj1 H_0(i)$ and
$H_{01}(i)$ for $\lam{y}(\proj2 H_0(i))(y)$, we have $H_1(q)$ of type
\begin{align*}
& \msm{A}{\mprd{\ctxwk{A}{A}}{\idtypevar{A}}}_1(q,H_0(i),H_0(j)) \\
& \jdeq \sm{e:A_1(q,H_{00}(i),H_{00}(j))}\mprd{\ctxwk{A}{A}}{\idtypevar{A}}_1(\pairr{q,e},H_{01}(i),H_{01}(j))\\
& \jdeq \sm{e:A_1(q,H_{00}(i),H_{00}(j))}\prd*{x:A_0(i)}*{y:A_0(j)}{d:A_1(q,x,y)}(\idtypevar{A})_1(\pairr{q,e},d,H_{01}(x),H_{01}(y))\\
& \jdeq \sm{e:A_1(q,H_{00}(i),H_{00}(j))}\prd*{x:A_0(i)}*{y:A_0(j)}{d:A_1(q,x,y)}\id{\trans{\pairr{H_{01}(x),H_{01}(y)}}{e}}{d}.
\end{align*}
By $H_0$, it follows that each $A_0(i)$ is contractible. By the contractibility
of each $A_0(i)$, it follows that the type of $H_1(q)$ is equivalent to
\begin{equation*}
\sm{e:A_1(q,H_{00}(i),H_{00}(j))}\prd{d:A_1(q,H_{00}(i),H_{00}(j))}\id{e}{d}
\end{equation*}
which asserts that $A_1(q,H_{00}(i),H_{00}(j))$ is contractible. By 
the contractibility of each $A_0(i)$, is is equivalent to the assertion
that each $A_1(q,x,y)$ is contractible.
\end{proof}

\begin{rmk}
We address the question whether it is the case that a graph $A$ in context
$\Gamma$ is contractible if and only if $\terms{A}$ is contractible. As a
consequence of \autoref{lem:contractible-graphs}, it is indeed the case
that $\terms{A}$ is contractible whenever $A$ is. However, the converse
does not hold.

To see this, we first construct a counter example to the converse of the
weak function extensionality principle, which states that there is a function
of type
\begin{equation}
\iscontr(\prd{x:X}P(x))\to\prd{x:X}\iscontr(P(x))\label{eq:wfe-converse}
\end{equation}
for any type family $P:X\to\type$. In the proof of \autoref{thm:wfe-converse}, 
we will find a family
$P:X\to\type$ with the property that $\prd{x:X}P(x)$ is contractible and for
which there is a term $x:A$ with $P(x)$ not contractible. Disproving the
converse of the weak function extensionality principle suffices for our
purposes, because if $P:X\to\type$ is a counter example to \autoref{eq:wfe-converse},
then we can take $\Gamma\defeq\pairr{\Gamma_0,\Gamma_1}$ to be given by
$\Gamma_0\defeq X$ and $\Gamma_1(i,j)\defeq\emptyt$ and we take
$A\defeq\pairr{A_0,A_1}$ to be given by $A_0\defeq P$ and $A_1(q,u,v)
\defeq\emptyt$.
\end{rmk}

We define the family $\mathcal{T}:\Sn^1\to\UU$ by
We define $\mathcal{T}(\base)\defeq\mathbf{3}$. To define $\mathcal{T}(\lloop):
\id{\mathbf{3}}{\mathbf{3}}$ we apply the univalence axiom. Hence it suffices to find an
equivalence $\eqv{\mathbf{3}}{\mathbf{3}}$, for which we take the function
$e$ defined by
\begin{equation*}
e(x)\defeq\begin{cases}
0_\mathbf{3} & \text{if }x\jdeq 0_\mathbf{3}\\
2_\mathbf{3} & \text{if }x\jdeq 1_\mathbf{3}\\
1_\mathbf{3} & \text{if }x\jdeq 2_\mathbf{3}.
\end{cases}
\end{equation*}

\begin{lem}
The type $\terms{\mathcal{T}}\defeq\prd{x:\Sn^1}\mathcal{T}(x)$ is contractible.
\end{lem}

\begin{proof}
The type of sections of $\mathcal{T}$ is equivalent to $\sm{u:\mathcal{T}(\base)}\id{e(u)}{u}$.
If we have a term $\pairr{u,\alpha}$ of the latter type, it follows by induction
on $\mathbf{3}$ that $\id{\pairr{u,\alpha}}
{\pairr{0_\mathbf{3},\refl{0_\mathbf{3}}}}$ for all $\pairr{u,\alpha}:
\sm{x:\mathcal{T}(\base)}\id{e(u)}{u}$,
which shows that the type of sections of $\mathcal{T}$ is contractible.
\end{proof}

\begin{thm}\label{thm:wfe-converse}
There is a type family $P:A\to\type$ for which
\begin{equation*}
\neg\Big(\iscontr(\prd{x:A}P(x))\to\prd{x:A}\iscontr(P(x))\Big).
\end{equation*}
\end{thm}

\begin{proof}
The type family of our counter example is $\mathcal{T}$: the fiber $\mathcal{T}(\base)$ isn't contractible.
\end{proof}

\begin{defn}
A graph morphism $f:\ctxhom{\Delta}{\Gamma}$ is an equivalence of graphs when
$\graphcharmap[\Gamma]{f}$ is a contractible graph in the context $\Gamma$.
\end{defn}

\begin{lem}
Let $A$ and $B$ be graphs in a context $\Gamma$ and let $f:A\to B$. The following are equivalent:
\begin{enumerate}
\item $f[i]:A[i]\to B[i]$ is an equivalence of graphs for every term $i:\Gamma$.
\item $\ctxext{\Gamma}f:\ctxext{\Gamma}A\to\ctxext{\Gamma}B$ is an equivalence of graphs.
\item Both $f_0(i)$ and $f_1(q,x,y)$ are always equivalences.
\item $\terms{f}:\terms{\Delta}\to\terms{\Gamma}$ is an equivalence.
\end{enumerate}
\end{lem}

\begin{rmk}
It follows that there is an equivalence
\begin{equation*}
\ctxext{\Gamma}\msm{A}{P}\simeq\ctxext({\Gamma}{A})P
\end{equation*}
for every family $P$ of graphs over a graph $A$ in context $\Gamma$.
\end{rmk}

\subsubsection{Homotopy levels}
\begin{itemize}
\item A graph $A$ in context $\Gamma$ is of homotopy level $n$ precisely when each
$A_0(i)$ and each $A_1(q,x,y)$ are of homotopy level $n$. 
\item We can name at least three different propositions in the empty context:
\begin{enumerate}
\item $\Gamma_0\defeq\emptyt$.
\item $\Gamma_0\defeq\unit$ and $\Gamma_1(\ttt,\ttt)\defeq\emptyt$.
\item $\Gamma_0\defeq\unit$ and $\Gamma_1(\ttt,\ttt)\defeq\unit$.
\end{enumerate}
Therefore $\mfGraph$ does not satisfy the law of excluded middle.
\end{itemize}



\subsubsection{Univalence for the graph model}
In the other direction, we also obtain a graph morphism $\graphcharmap[\Gamma]{f}:
\ctxhom{\Gamma}{\gobjclass}$ for every graph morphism $f:\ctxhom{\Delta}{\Gamma}$.
In \autoref{graph-object-classifier} we will prove that the maps
$\int_\Gamma:\ctxhom{\Gamma}{\gobjclass}\to\sm{\Delta:\tfGraph}\ctxhom{\Delta}{\Gamma}$
is an equivalence with iverse $\graphcharmapfunc{\Gamma}$. 

\begin{defn}
Let $f:\Delta\to\Gamma$ be a graph morphism. We define the graph morphism
$\graphcharmap[\Gamma]{f}$ by
\begin{align*}
\graphcharmap[\Gamma]{f}_0 & \defeq \lam{i}\hfib{f_0}{i}\\
\graphcharmap[\Gamma]{f}_1(i,j) & \defeq \lam{q}\hfib{f_1(i,j)}{q}.
\end{align*}
\end{defn}


\begin{thm}\label{graph-object-classifier}
Main theorem here.
\end{thm}

\begin{comment}
To describe the object classifier for graphs, we will follow Streicher. Thus
we have to look at presheaves over $I/i$ for each object $i$ of the category
$I\defeq 0{\rightrightarrows}1$ with the morphisms named $s$ and $t$ for source
and target. The category $I/0$ is the terminal category;
the category $I/1$ looks like $\cdot{\rightarrow}\cdot{\leftarrow}\cdot$.
Therefore, we have
\begin{align*}
\type^{\op{(I/0)}} & \eqv{}{\type},\\
\type^{\op{(I/1)}} & \eqv{}{\sm{X,Y,A:\type}(A\to X)\times(A\to Y)}\\
& \eqv{}{\sm{X,Y:\type}X\to Y\to\type}.
\end{align*}
The functors $\type^\op{\Sigma_s}$ and $\type^\op{\Sigma_t}$ are given by
$\pi_1$ and $\pi_2$ respectively. This leads to our following definition
of the object classifier $\gobjclass$:

\begin{defn}
Define $\gobjclass$ to be the graph consisting of
\begin{align*}
\gobjclass_0 & \defeq  \type\\
\gobjclass_1(X,Y) & \defeq  X\to Y\to\type
\end{align*}
and define $\pointed{\gobjclass}$ by
\begin{align*}
(\pointed{\gobjclass})_0 & \defeq  \pointed{\type}\\
(\pointed{\gobjclass})_1(\pairr{X,x},\pairr{Y,y}) & \defeq  \sm{R:X\to Y\to\type}R(x,y)
\end{align*}
There is the obvious forgetful graph morphism $t:\pointed{\gobjclass}\to\gobjclass$,
given by projection on the first coordinate.

For any morphism $f:\Delta\to\Gamma$ of graphs we define a morphism
$\graphcharmap(f):\Gamma\to\gobjclass$ of graphs by
\begin{align*}
\graphcharmap(f)_0(i) & \defeq  \hfiber{f_0}{i}\\
\graphcharmap(f)_1(q,\pairr{u,\alpha},\pairr{v,\beta}) & \defeq  \sm{p:\Delta_1(u,v)}
\id{\trans{\pairr{\alpha,\beta}}{f_1(p)}}{q}
\end{align*}
where $\pairr{u,\alpha}:\graphcharmap(f)_0(i)$ and $\pairr{v,\beta}:\graphcharmap(f)_0(j)$. The
morphism $\graphcharmap(f)$ is called the \emph{characteristic map of $f$}. We obtain a function
\begin{equation*}
\graphcharmap : \big(\sm{\Delta:\tfGraph }\Delta\to\Gamma\big)\to\big(\Gamma\to\gobjclass\big)
\end{equation*}
for every graph $\Gamma$.
\end{defn}

\begin{thm}\label{thm:graph-classifier1}
The function $\graphcharmap$ is an equivalence for any graph $\Gamma$.
\end{thm}

\begin{proof}
We have to find a quasi-inverse
\begin{align*}
\Sigma : (\Gamma\to\gobjclass)\to\big(\sm{\Delta:\tfGraph}\Delta\to\Gamma\big)
\end{align*}
of $\graphcharmap$. Thus, we have to define $\Sigma_0:(\Gamma\to\gobjclass)\to\tfGraph$ and
$\Sigma_1:\prd{P:\Gamma\to\gobjclass}\Sigma_0(P)\to\Gamma$. For $P:\Gamma\to\gobjclass$ we define
\begin{align*}
\Sigma_0(P)_0 & \defeq \sm{i:\Gamma_0}P_0(i)\\
\Sigma_0(P)_1(\pairr{i,u},\pairr{j,v}) & \defeq \sm{q:\Gamma_1(i,j)}P_1(q,u,v)\\
\Sigma_1(P)_0 & \defeq \proj1\\
\Sigma_1(P)_1(\pairr{i,u},\pairr{j,v}) & \defeq \proj1.
\end{align*}
\end{proof}

\begin{thm}\label{conj:graph_classifier2}
For any graph morphism $f:\Delta\to\Gamma$, the diagram
\begin{equation*}
\begin{tikzcd}
\Delta \ar{r}{} \ar{d}[swap]{f} & \pointed{\gobjclass} \ar{d}{t} \\ 
\Gamma \ar{r}[swap]{\graphcharmap(f)} & \gobjclass 
\end{tikzcd}
\end{equation*}
is a pullback square.
\end{thm}
\note{We would like it to be a pb \emph{in} the graph model}
\end{comment}

\begingroup\color{blue}
\subsubsection{The adjunctions $\tfcolim\dashv\Delta\dashv\tflim$}
We define $\Delta:\type\to\tfGraph$ by
\begin{equation*}
\Delta(X)\defeq\pairr{X,\lam{x}{x'}\id{x}{x'}}
\end{equation*}
for $X:\type$. For $A:X\to\type$ we define $\Delta(A):\mftyp(\Delta(X))$ by
\begin{align*}
\Delta(A)_0(x) & \defeq A(x)\\
\Delta(A)_1(p,a,b) & \defeq \id{\trans{p}{a}}{b}.
\end{align*}

\begin{lem}
For any type $X$ and any graph $\Gamma$ there is an equivalence
\begin{equation*}
\eqv{(X\to\terms{\Gamma})}{\terms{\Delta(X)\to\Gamma}}.
\end{equation*}
\end{lem}

\begin{proof}
We have to find functions
\begin{align*}
\varphi & : (X\to\terms{\Gamma})\to\terms{\Delta(X)\to\Gamma}\\
\psi & : \terms{\Delta(X)\to\Gamma}\to X\to\terms{\Gamma}
\end{align*}
which are each others homotopy inverse. To define $\varphi$, let
\end{proof}
\endgroup

